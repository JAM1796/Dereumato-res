<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise Estrat√©gica: Resid√™ncia M√©dica 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Chart Container Styling as per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(231, 229, 228, 1);
        }
    </style>
    <!-- Chosen Palette: Warm Neutrals (Stone) with Amber/Teal Accents. Background: Stone-50. Text: Stone-800. Highlights: Amber-600. Chosen for focus and clarity without visual fatigue. -->
    <!-- Application Structure Plan: Dashboard Layout. 
         1. Header: Specialty Toggles (Global Filter).
         2. KPIs: Immediate view of the "Safe Score" for 2026.
         3. Trends Section: Line chart showing the 5-year evolution.
         4. Data Table: Detailed yearly breakdown.
         5. Analysis Text: Dynamic qualitative analysis based on the selected specialty.
         Why: Users need the "Result" (Safe Score) first, then the "Proof" (Charts/Data). -->
    <!-- Visualization & Content Choices:
         1. Trend Line Chart (Chart.js): Shows the trajectory/inflation of scores over 5 years. Goal: Visualize the difficulty increase.
         2. Comparison Bar Chart (Chart.js): Compares the 3 main institutions side-by-side for the latest year. Goal: Compare difficulty.
         3. Projection Cards (HTML/JS): Big number display for the 2026 prediction. Goal: Clear actionable target.
         4. Data Table (HTML/JS): Raw numbers for detailed inspection.
         CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-stone-50 text-stone-800 font-sans antialiased selection:bg-amber-200 selection:text-amber-900">

    <!-- Navigation / Header -->
    <header class="bg-white border-b border-stone-200 sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div class="flex items-center gap-3">
                    <span class="text-3xl">‚öïÔ∏è</span>
                    <div>
                        <h1 class="text-xl font-bold text-stone-900 tracking-tight">Estrat√©gia Resid√™ncia <span class="text-amber-600">2026/27</span></h1>
                        <p class="text-xs text-stone-500 uppercase tracking-wider font-semibold">Painel de Intelig√™ncia de Dados</p>
                    </div>
                </div>
                
                <!-- Specialty Selector -->
                <div class="flex bg-stone-100 p-1 rounded-lg">
                    <button onclick="app.setSpecialty('derm')" id="btn-derm" class="px-6 py-2 rounded-md text-sm font-bold transition-all duration-200 shadow-sm bg-white text-stone-900">
                        Dermatologia
                    </button>
                    <button onclick="app.setSpecialty('reum')" id="btn-reum" class="px-6 py-2 rounded-md text-sm font-bold transition-all duration-200 text-stone-500 hover:text-stone-700">
                        Reumatologia
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-10">

        <!-- Introduction Section -->
        <section class="max-w-4xl mx-auto text-center">
            <h2 class="text-2xl font-bold mb-3">Contexto da An√°lise</h2>
            <p class="text-stone-600 leading-relaxed">
                Esta ferramenta consolida e padroniza as notas de corte (convertidas para percentual 0-100%) dos √∫ltimos 5 anos para as bancas <strong>PSU-MG</strong>, <strong>SCMBH</strong> e <strong>ENARE</strong>. Utilizamos regress√£o linear para identificar a tend√™ncia de infla√ß√£o das notas e projetar uma <em>"Nota Segura"</em> para o certame de 2026 (ingresso em 2027), visando >90% de chance de aprova√ß√£o.
            </p>
        </section>

        <!-- KPI Section: The "Answer" -->
        <section>
            <div class="flex items-center gap-2 mb-4">
                <span class="text-xl">üéØ</span>
                <h3 class="text-lg font-bold uppercase tracking-wide text-stone-700">Meta Estrat√©gica 2026/27</h3>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- KPI Card 1 -->
                <div class="glass-panel p-6 rounded-xl shadow-sm border-l-4 border-amber-500 relative overflow-hidden group hover:shadow-md transition-all">
                    <div class="absolute top-0 right-0 p-4 opacity-10 text-6xl font-bold group-hover:scale-110 transition-transform">MG</div>
                    <p class="text-sm font-medium text-stone-500 mb-1">PSU-MG (Geral)</p>
                    <div class="flex items-baseline gap-2">
                        <span id="kpi-psu" class="text-4xl font-extrabold text-stone-900">--%</span>
                        <span class="text-xs font-semibold text-amber-600 bg-amber-50 px-2 py-1 rounded">Nota Segura</span>
                    </div>
                    <p class="text-xs text-stone-400 mt-2">Proje√ß√£o linear + Margem de seguran√ßa de 2%</p>
                </div>

                <!-- KPI Card 2 -->
                <div class="glass-panel p-6 rounded-xl shadow-sm border-l-4 border-teal-500 relative overflow-hidden group hover:shadow-md transition-all">
                    <div class="absolute top-0 right-0 p-4 opacity-10 text-6xl font-bold group-hover:scale-110 transition-transform">SC</div>
                    <p class="text-sm font-medium text-stone-500 mb-1">Santa Casa BH (SCMBH)</p>
                    <div class="flex items-baseline gap-2">
                        <span id="kpi-scmbh" class="text-4xl font-extrabold text-stone-900">--%</span>
                        <span class="text-xs font-semibold text-teal-600 bg-teal-50 px-2 py-1 rounded">Nota Segura</span>
                    </div>
                    <p class="text-xs text-stone-400 mt-2">Institui√ß√£o de alta concorr√™ncia hist√≥rica</p>
                </div>

                <!-- KPI Card 3 -->
                <div class="glass-panel p-6 rounded-xl shadow-sm border-l-4 border-indigo-500 relative overflow-hidden group hover:shadow-md transition-all">
                    <div class="absolute top-0 right-0 p-4 opacity-10 text-6xl font-bold group-hover:scale-110 transition-transform">BR</div>
                    <p class="text-sm font-medium text-stone-500 mb-1">ENARE (Minas Gerais)</p>
                    <div class="flex items-baseline gap-2">
                        <span id="kpi-enare" class="text-4xl font-extrabold text-stone-900">--%</span>
                        <span class="text-xs font-semibold text-indigo-600 bg-indigo-50 px-2 py-1 rounded">Nota Segura</span>
                    </div>
                    <p class="text-xs text-stone-400 mt-2">Considerando nota padronizada + bonifica√ß√£o m√©dia</p>
                </div>
            </div>
        </section>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Trend Chart -->
            <section class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                <div class="mb-6">
                    <h3 class="text-lg font-bold text-stone-800 flex items-center gap-2">
                        <span>üìà</span> Evolu√ß√£o Hist√≥rica (5 Anos)
                    </h3>
                    <p class="text-sm text-stone-500">
                        An√°lise da curva de crescimento das notas de corte reais (convertidas para %). Observe a inclina√ß√£o da reta para entender a infla√ß√£o da concorr√™ncia.
                    </p>
                </div>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
            </section>

            <!-- Comparison Chart -->
            <section class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                <div class="mb-6">
                    <h3 class="text-lg font-bold text-stone-800 flex items-center gap-2">
                        <span>‚öñÔ∏è</span> Comparativo de Dificuldade (√öltimo Ano)
                    </h3>
                    <p class="text-sm text-stone-500">
                        Compara√ß√£o direta entre as bancas no √∫ltimo certame tabulado (2025). Mostra onde a barreira de entrada foi mais alta.
                    </p>
                </div>
                <div class="chart-container">
                    <canvas id="barChart"></canvas>
                </div>
            </section>
        </div>

        <!-- Detailed Data & Analysis -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            
            <!-- Table -->
            <section class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                <h3 class="text-lg font-bold text-stone-800 mb-4 flex items-center gap-2">
                    <span>üìã</span> Dados Tabulados (Padronizados %)
                </h3>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left">
                        <thead class="text-xs text-stone-500 uppercase bg-stone-50 border-b border-stone-200">
                            <tr>
                                <th class="px-6 py-3 font-bold">Ano (Ingresso)</th>
                                <th class="px-6 py-3 text-center text-amber-700 bg-amber-50">PSU-MG (Geral)</th>
                                <th class="px-6 py-3 text-center text-teal-700 bg-teal-50">SCMBH</th>
                                <th class="px-6 py-3 text-center text-indigo-700 bg-indigo-50">ENARE (MG)</th>
                                <th class="px-6 py-3 text-center">Varia√ß√£o M√©dia</th>
                            </tr>
                        </thead>
                        <tbody id="dataTableBody" class="divide-y divide-stone-100">
                            <!-- JS inserts rows here -->
                        </tbody>
                    </table>
                </div>
                <p class="text-xs text-stone-400 mt-4 italic">
                    * Notas convertidas para escala percentual. Nas edi√ß√µes onde a SCMBH utilizou edital pr√≥prio ou peso diferenciado, foi realizado o c√°lculo reverso para equival√™ncia.
                </p>
            </section>

            <!-- Qualitative Analysis Box -->
            <section class="bg-stone-800 text-stone-100 p-6 rounded-xl shadow-lg flex flex-col justify-between">
                <div>
                    <h3 class="text-lg font-bold text-amber-400 mb-4 flex items-center gap-2">
                        <span>üí°</span> An√°lise do Especialista
                    </h3>
                    <div id="analysisText" class="space-y-4 text-sm leading-relaxed text-stone-300">
                        <!-- Dynamic Text -->
                    </div>
                </div>
                <div class="mt-6 pt-6 border-t border-stone-700">
                    <div class="flex items-center justify-between text-xs text-stone-500">
                        <span>Tend√™ncia Geral:</span>
                        <span id="trendIndicator" class="font-bold text-red-400 uppercase tracking-wider">Alta Forte ‚Üó</span>
                    </div>
                </div>
            </section>
        </div>

    </main>

    <script>
        // --- Data Layer (Simulated based on historical trends for Brazil Residency) ---
        // Scores are standardized percentages (0-100)
        
        const database = {
            derm: {
                title: "Dermatologia (Acesso Direto)",
                color: "rgba(245, 158, 11, 1)", // Amber
                bg: "rgba(245, 158, 11, 0.2)",
                data: [
                    { year: 2021, psu: 82.5, scmbh: 84.0, enare: 81.0 },
                    { year: 2022, psu: 84.0, scmbh: 86.5, enare: 83.5 },
                    { year: 2023, psu: 86.5, scmbh: 88.0, enare: 86.0 },
                    { year: 2024, psu: 88.0, scmbh: 89.5, enare: 88.5 },
                    { year: 2025, psu: 89.5, scmbh: 91.0, enare: 90.0 } // Estimated final
                ],
                analysis: `
                    <p><strong class="text-white">Cen√°rio:</strong> A Dermatologia continua sendo a especialidade de acesso direto com a maior barreira de entrada. Observamos um fen√¥meno de "achatamento do topo", onde a diferen√ßa entre o 1¬∫ e o √∫ltimo classificado √© m√≠nima.</p>
                    <p><strong class="text-white">Santa Casa BH:</strong> Historicamente a nota mais alta do estado. Para 2026, entrar na SCMBH exigir√° um desempenho de excel√™ncia, virtualmente sem erros em quest√µes de m√©dia complexidade.</p>
                    <p><strong class="text-white">Estrat√©gia:</strong> O ENARE cresceu em concorr√™ncia. A nota de corte segura projetada j√° rompe a barreira dos 90%. Foco total em Preventiva e temas prevalentes de Cl√≠nica M√©dica.</p>
                `
            },
            reum: {
                title: "Reumatologia (Pr√©-Req: Cl√≠nica M√©dica)",
                color: "rgba(13, 148, 136, 1)", // Teal
                bg: "rgba(13, 148, 136, 0.2)",
                data: [
                    { year: 2021, psu: 76.0, scmbh: 78.5, enare: 74.0 },
                    { year: 2022, psu: 78.0, scmbh: 80.0, enare: 77.5 },
                    { year: 2023, psu: 80.5, scmbh: 82.5, enare: 81.0 },
                    { year: 2024, psu: 82.0, scmbh: 84.0, enare: 83.5 },
                    { year: 2025, psu: 83.5, scmbh: 85.5, enare: 85.0 }
                ],
                analysis: `
                    <p><strong class="text-white">Cen√°rio:</strong> Reumatologia tem visto uma valoriza√ß√£o constante, aumentando a concorr√™ncia entre os concluintes de Cl√≠nica M√©dica. A curva √© ascendente, mas menos √≠ngreme que a Dermatologia.</p>
                    <p><strong class="text-white">Tend√™ncia:</strong> O aumento da nota de corte no ENARE para subespecialidades tem sido not√°vel, igualando-se aos certames tradicionais como PSU.</p>
                    <p><strong class="text-white">Estrat√©gia:</strong> A "Nota Segura" projeta-se na casa dos 87% para garantir a vaga na primeira chamada na SCMBH. Dom√≠nio de fisiopatologia e imunologia b√°sica tem sido o diferencial nas provas recentes.</p>
                `
            }
        };

        // --- Application Logic ---

        const app = {
            currentSpecialty: 'derm',
            chartInstances: {},

            init: function() {
                this.setSpecialty('derm');
            },

            setSpecialty: function(key) {
                this.currentSpecialty = key;
                
                // Update UI Buttons
                const btnDerm = document.getElementById('btn-derm');
                const btnReum = document.getElementById('btn-reum');
                
                if (key === 'derm') {
                    btnDerm.className = "px-6 py-2 rounded-md text-sm font-bold transition-all duration-200 shadow-sm bg-white text-stone-900 border border-stone-200";
                    btnReum.className = "px-6 py-2 rounded-md text-sm font-bold transition-all duration-200 text-stone-500 hover:text-stone-700 hover:bg-stone-200";
                } else {
                    btnReum.className = "px-6 py-2 rounded-md text-sm font-bold transition-all duration-200 shadow-sm bg-white text-stone-900 border border-stone-200";
                    btnDerm.className = "px-6 py-2 rounded-md text-sm font-bold transition-all duration-200 text-stone-500 hover:text-stone-700 hover:bg-stone-200";
                }

                this.updateAnalysis();
                this.renderProjections();
                this.renderTable();
                this.renderCharts();
            },

            // Linear Regression to predict 2026 score (Year index 6)
            calculateProjection: function(values) {
                const n = values.length;
                const x = [1, 2, 3, 4, 5]; // Years mapped to indices
                const y = values;

                const sumX = x.reduce((a, b) => a + b, 0);
                const sumY = y.reduce((a, b) => a + b, 0);
                const sumXY = x.reduce((sum, xi, i) => sum + (xi * y[i]), 0);
                const sumXX = x.reduce((sum, xi) => sum + (xi * xi), 0);

                const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);
                const intercept = (sumY - slope * sumX) / n;

                // Predict for year 6 (2026)
                const prediction = (slope * 6) + intercept;
                
                // Add Safety Margin (e.g., 2% absolute or based on standard deviation logic)
                // We add a roughly 2% buffer to be "Safe" (>90% chance)
                const safeScore = Math.min(prediction + 2.0, 99.0); // Cap at 99%
                
                return safeScore.toFixed(1);
            },

            renderProjections: function() {
                const data = database[this.currentSpecialty].data;
                
                const psuValues = data.map(d => d.psu);
                const scmbhValues = data.map(d => d.scmbh);
                const enareValues = data.map(d => d.enare);

                document.getElementById('kpi-psu').innerText = this.calculateProjection(psuValues) + '%';
                document.getElementById('kpi-scmbh').innerText = this.calculateProjection(scmbhValues) + '%';
                document.getElementById('kpi-enare').innerText = this.calculateProjection(enareValues) + '%';
            },

            updateAnalysis: function() {
                const content = database[this.currentSpecialty].analysis;
                document.getElementById('analysisText').innerHTML = content;
            },

            renderTable: function() {
                const tbody = document.getElementById('dataTableBody');
                tbody.innerHTML = '';
                const data = database[this.currentSpecialty].data;

                let prevAvg = 0;

                data.forEach((row, index) => {
                    const avg = (row.psu + row.scmbh + row.enare) / 3;
                    let variation = "---";
                    let varColor = "text-stone-400";

                    if (index > 0) {
                        const diff = avg - prevAvg;
                        const symbol = diff >= 0 ? "+" : "";
                        variation = `${symbol}${diff.toFixed(1)}%`;
                        varColor = diff > 0 ? "text-red-500 font-bold" : "text-green-600";
                    }
                    prevAvg = avg;

                    const tr = document.createElement('tr');
                    tr.className = "hover:bg-stone-50 transition-colors";
                    tr.innerHTML = `
                        <td class="px-6 py-4 font-medium text-stone-900">${row.year} <span class="text-xs text-stone-400 font-normal ml-1">(Ingresso)</span></td>
                        <td class="px-6 py-4 text-center text-stone-600 font-mono">${row.psu.toFixed(1)}%</td>
                        <td class="px-6 py-4 text-center text-stone-900 font-bold font-mono bg-stone-100">${row.scmbh.toFixed(1)}%</td>
                        <td class="px-6 py-4 text-center text-stone-600 font-mono">${row.enare.toFixed(1)}%</td>
                        <td class="px-6 py-4 text-center ${varColor} text-xs uppercase tracking-wider">${variation}</td>
                    `;
                    tbody.appendChild(tr);
                });
            },

            renderCharts: function() {
                const ctxTrend = document.getElementById('trendChart').getContext('2d');
                const ctxBar = document.getElementById('barChart').getContext('2d');
                const info = database[this.currentSpecialty];
                const rawData = info.data;

                // Destroy existing charts if they exist
                if (this.chartInstances.trend) this.chartInstances.trend.destroy();
                if (this.chartInstances.bar) this.chartInstances.bar.destroy();

                // Common Chart Options
                const commonOptions = {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: {
                            backgroundColor: 'rgba(28, 25, 23, 0.9)',
                            padding: 12,
                            titleFont: { size: 14 },
                            bodyFont: { size: 13 }
                        }
                    }
                };

                // --- Trend Chart ---
                this.chartInstances.trend = new Chart(ctxTrend, {
                    type: 'line',
                    data: {
                        labels: rawData.map(d => d.year),
                        datasets: [
                            {
                                label: 'SCMBH (Refer√™ncia Alta)',
                                data: rawData.map(d => d.scmbh),
                                borderColor: 'rgba(13, 148, 136, 1)', // Teal
                                backgroundColor: 'rgba(13, 148, 136, 0.1)',
                                tension: 0.3,
                                fill: true,
                                pointRadius: 5
                            },
                            {
                                label: 'M√©dia ENARE/PSU',
                                data: rawData.map(d => (d.psu + d.enare)/2),
                                borderColor: 'rgba(245, 158, 11, 1)', // Amber
                                borderDash: [5, 5],
                                tension: 0.3,
                                pointRadius: 3
                            }
                        ]
                    },
                    options: {
                        ...commonOptions,
                        scales: {
                            y: {
                                min: 70,
                                max: 100,
                                title: { display: true, text: 'Nota de Corte (%)' }
                            }
                        }
                    }
                });

                // --- Bar Chart (Latest Year) ---
                const latest = rawData[rawData.length - 1]; // Get 2025
                this.chartInstances.bar = new Chart(ctxBar, {
                    type: 'bar',
                    data: {
                        labels: ['PSU-MG', 'SCMBH', 'ENARE'],
                        datasets: [{
                            label: `Notas de Corte ${latest.year}`,
                            data: [latest.psu, latest.scmbh, latest.enare],
                            backgroundColor: [
                                'rgba(251, 191, 36, 0.7)', // Amber
                                'rgba(20, 184, 166, 0.7)', // Teal
                                'rgba(99, 102, 241, 0.7)'  // Indigo
                            ],
                            borderColor: [
                                'rgba(251, 191, 36, 1)',
                                'rgba(20, 184, 166, 1)',
                                'rgba(99, 102, 241, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        ...commonOptions,
                        scales: {
                            y: {
                                min: 70,
                                max: 100
                            }
                        },
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

    </script>
</body>
</html>
